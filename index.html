<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥–∞–∑–∏–Ω "–î–ª—è —Å–≤–æ–∏—Ö" - –í—Å—ë –¥–ª—è –¥–æ–º–∞ –∏ —Ä–µ–º–æ–Ω—Ç–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* ==================== –û–°–ù–û–í–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==================== */
        :root {
            --primary: #2c5aa0;
            --primary-dark: #1a3a6b;
            --primary-light: #4a7ac7;
            --secondary: #e74c3c;
            --accent: #27ae60;
            --accent-light: #2ecc71;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --gray: #6c757d;
            --gray-light: #ecf0f1;
            --border: #e9ecef;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            
            --radius: 10px;
            --shadow: 0 5px 15px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.15);
            --transition: all 0.3s ease;
            
            --bg-gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --text-gradient: linear-gradient(135deg, var(--primary), var(--primary-light));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f7fa;
            min-height: 100vh;
            padding-top: 80px;
        }

        /* ==================== –ö–û–ù–°–¢–†–£–ö–¢–û–† –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê ==================== */
        .constructor-toolbar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: var(--transition);
            overflow: hidden;
        }

        .constructor-toggle {
            width: 50px;
            height: 50px;
            background: var(--bg-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.2rem;
        }

        .constructor-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(44, 90, 160, 0.4);
        }

        .constructor-toolbar.expanded {
            border-radius: 25px;
            padding: 15px;
        }

        #editButtons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            animation: fadeIn 0.3s ease;
        }

        .edit-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--border);
            color: var(--dark);
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
            white-space: nowrap;
        }

        .edit-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateX(-5px);
        }

        .edit-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 9998;
            display: none;
        }

        .edit-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 9999;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
            display: none;
        }

        .edit-panel-content {
            max-height: calc(90vh - 120px);
            overflow-y: auto;
            padding-right: 10px;
        }

        .edit-panel-content::-webkit-scrollbar {
            width: 6px;
        }

        .edit-panel-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .edit-panel-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        /* ==================== –•–ï–î–ï–† ==================== */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .header-top {
            background: var(--bg-gradient);
            color: white;
            padding: 8px 0;
            font-size: 14px;
        }

        .header-main {
            padding: 15px 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-main .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: transparent;
            background: var(--text-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            text-decoration: none;
        }

        .search-bar {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 50px 12px 20px;
            border: 2px solid var(--border);
            border-radius: 30px;
            font-size: 14px;
            background: white;
            transition: var(--transition);
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bg-gradient);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-action {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--dark);
            font-size: 12px;
            transition: var(--transition);
            position: relative;
        }

        .header-action:hover {
            transform: translateY(-2px);
            color: var(--primary);
        }

        .header-action i {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .cart-count, .notification-count {
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -5px;
            right: -5px;
            font-weight: bold;
        }

        .notification-count {
            background: var(--accent);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
            padding: 8px 15px;
            background: var(--light);
            border-radius: 25px;
            border: 1px solid var(--border);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-size: 12px;
            font-weight: bold;
        }

        .user-role {
            font-size: 10px;
            color: var(--gray);
        }

        .logout-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .logout-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* ==================== –ì–õ–ê–í–ù–ê–Ø –°–ï–ö–¶–ò–Ø ==================== */
        .hero {
            background: var(--bg-gradient);
            color: white;
            padding: 100px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600" opacity="0.1"><path d="M0 0h1200v600H0z" fill="none"/><path d="M0 300c200-200 400 200 600 0s400-200 600 0v300H0z" fill="white"/></svg>');
            background-size: cover;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        /* ==================== –ö–ê–¢–ï–ì–û–†–ò–ò ==================== */
        .section {
            padding: 80px 0;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 50px;
            color: var(--dark);
            position: relative;
            font-weight: 700;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: var(--bg-gradient);
            margin: 15px auto;
            border-radius: 2px;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .category-card {
            background: white;
            border-radius: var(--radius);
            padding: 30px 20px;
            text-align: center;
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .category-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
            color: var(--primary);
        }

        .category-card h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .category-description {
            color: var(--gray);
            font-size: 0.95rem;
            line-height: 1.4;
        }

        /* ==================== –¢–û–í–ê–†–´ ==================== */
        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .filters {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 10px 20px;
            border: 2px solid var(--border);
            border-radius: 25px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }

        .product-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--secondary);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 2;
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
            height: 200px;
            background: var(--gray-light);
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-info {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-category {
            color: var(--gray);
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .product-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
            line-height: 1.3;
            flex-grow: 1;
        }

        .product-description-short {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .current-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .old-price {
            font-size: 1.1rem;
            color: var(--gray);
            text-decoration: line-through;
        }

        .discount {
            background: var(--accent);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .product-status {
            font-size: 0.8rem;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: 600;
            align-self: flex-start;
        }

        .status-in-stock {
            background: rgba(40, 167, 69, 0.1);
            color: #155724;
            border: 1px solid rgba(40, 167, 69, 0.2);
        }

        .status-pre-order {
            background: rgba(255, 193, 7, 0.1);
            color: #856404;
            border: 1px solid rgba(255, 193, 7, 0.2);
        }

        .status-out-of-stock {
            background: rgba(220, 53, 69, 0.1);
            color: #721c24;
            border: 1px solid rgba(220, 53, 69, 0.2);
        }

        .product-actions {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--bg-gradient);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(44, 90, 160, 0.3);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--accent);
            color: white;
            border: none;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            border: none;
        }

        .btn-sm {
            padding: 8px 15px;
            font-size: 14px;
        }

        .add-to-cart {
            flex: 1;
        }

        .add-to-cart:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* ==================== –§–£–¢–ï–† ==================== */
        footer {
            background: var(--dark);
            color: white;
            padding: 60px 0 20px;
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #bdc3c7;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.7);
        }

        /* ==================== –£–¢–ò–õ–ò–¢–´ ==================== */
        .text-center {
            text-align: center;
        }

        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ==================== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ==================== */
        @media (max-width: 992px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 140px;
            }
            
            .header-main .container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-bar {
                min-width: 100%;
                order: 3;
                margin-top: 15px;
            }
            
            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .hero {
                padding: 60px 0;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1.1rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .products-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filters {
                justify-content: center;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .edit-panel {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-select {
                width: 100%;
            }
            
            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
    <div class="constructor-toolbar" id="constructorToolbar">
        <div class="constructor-toggle" onclick="toggleConstructor()">
            <i class="fas fa-cogs"></i>
        </div>
        <div id="editButtons" style="display: none;">
            <button class="edit-btn" onclick="editBackground()"><i class="fas fa-palette"></i> –§–æ–Ω</button>
            <button class="edit-btn" onclick="editHeader()"><i class="fas fa-header"></i> –®–∞–ø–∫–∞</button>
            <button class="edit-btn" onclick="editCategories()"><i class="fas fa-tags"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
            <button class="edit-btn" onclick="manageProducts()"><i class="fas fa-box"></i> –¢–æ–≤–∞—Ä—ã</button>
            <button class="edit-btn" onclick="showImportPanel()"><i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç</button>
            <button class="edit-btn" onclick="manageOrders()"><i class="fas fa-clipboard-list"></i> –ó–∞–∫–∞–∑—ã</button>
            <button class="edit-btn" onclick="saveDesign()"><i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button class="edit-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏</button>
        </div>
    </div>

    <div class="edit-overlay" id="editOverlay" onclick="closePanel()"></div>

    <!-- –ü–∞–Ω–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="edit-panel" id="editPanel">
        <div class="edit-panel-content" id="editPanelContent">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
        <div style="padding: 20px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 10px;">
            <button class="btn btn-primary" onclick="applyChanges()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <button class="btn btn-outline" onclick="closePanel()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="cartModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--border);">
                <h3 style="margin: 0;"><i class="fas fa-shopping-cart"></i> –ö–æ—Ä–∑–∏–Ω–∞</h3>
                <button onclick="closeModal('cartModal')" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray);">&times;</button>
            </div>
            <div id="cartItems">
                <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
            </div>
            <div id="cartEmpty" style="text-align: center; padding: 40px; color: var(--gray); display: none;">
                <i class="fas fa-shopping-cart" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                <p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
            </div>
            <div id="cartTotal" style="text-align: right; margin-top: 20px; padding-top: 20px; border-top: 2px solid var(--border); font-size: 1.2rem; font-weight: bold; display: none;">
                –ò—Ç–æ–≥–æ: <span id="totalAmount">0</span> ‚ÇΩ
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="checkout()" style="flex: 1;">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                <button class="btn btn-outline" onclick="closeModal('cartModal')">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</button>
            </div>
        </div>
    </div>

    <!-- –•–µ–¥–µ—Ä -->
    <header>
        <div class="header-top">
            <div class="container">
                <div class="header-contacts">
                    <i class="fas fa-phone"></i> +7 (923) 753-36-06
                    <span style="margin: 0 15px">|</span>
                    <i class="fas fa-envelope"></i> prodtorg.barnaul@gmail.com
                </div>
            </div>
        </div>
        <div class="header-main">
            <div class="container">
                <a href="#" class="logo">D13 - –î–õ–Ø –°–í–û–ò–•</a>
                
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
                    <button onclick="searchProducts()"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="header-actions">
                    <a href="#" class="header-action" onclick="openProfile(); return false;">
                        <i class="fas fa-user"></i>
                        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                    </a>
                    <a href="#" class="header-action" onclick="openCart(); return false;" style="position: relative;">
                        <i class="fas fa-shopping-cart"></i>
                        <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
                        <div class="cart-count" id="cartCount">0</div>
                    </a>
                    <div class="user-info" id="userInfo">
                        <div class="user-avatar">–ê</div>
                        <div class="user-details">
                            <div class="user-name">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                            <div class="user-role">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        </div>
                        <button class="logout-btn" onclick="logout()" title="–í—ã–π—Ç–∏">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- –ì–ª–∞–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è -->
    <section class="hero">
        <div class="hero-content">
            <h1 id="heroTitle">D13 - –í—Å—ë –¥–ª—è –¥–æ–º–∞ –∏ —Ä–µ–º–æ–Ω—Ç–∞</h1>
            <p id="heroText">–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞, —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∏</p>
            <button class="btn btn-primary" style="margin-top: 20px; padding: 15px 30px; font-size: 1.1rem;" onclick="scrollToProducts()">
                <i class="fas fa-shopping-bag"></i> –°–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–≤–∞—Ä—ã
            </button>
        </div>
    </section>

    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <section class="section" style="background: white;">
        <div class="container">
            <h2 class="section-title">–ö–ê–¢–ï–ì–û–†–ò–ò –¢–û–í–ê–†–û–í</h2>
            <div class="categories-grid" id="categoriesGrid">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </section>

    <!-- –¢–æ–≤–∞—Ä—ã -->
    <section class="section" id="productsSection">
        <div class="container">
            <div class="products-header">
                <h2 class="section-title" style="text-align: left; margin: 0;">–í–°–ï –¢–û–í–ê–†–´</h2>
                <div class="filters">
                    <select class="filter-select" id="categoryFilter" onchange="filterProducts()">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    </select>
                    <select class="filter-select" id="priceFilter" onchange="filterProducts()">
                        <option value="">–õ—é–±–∞—è —Ü–µ–Ω–∞</option>
                        <option value="0-500">–î–æ 500 —Ä—É–±.</option>
                        <option value="500-1000">500-1000 —Ä—É–±.</option>
                        <option value="1000-5000">1000-5000 —Ä—É–±.</option>
                        <option value="5000-999999">–û—Ç 5000 —Ä—É–±.</option>
                    </select>
                    <select class="filter-select" id="sortBy" onchange="sortProducts()">
                        <option value="name">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</option>
                        <option value="price_asc">–¶–µ–Ω–∞ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é)</option>
                        <option value="price_desc">–¶–µ–Ω–∞ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)</option>
                        <option value="name">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                    </select>
                </div>
            </div>
            <div class="products-grid" id="productsGrid">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </section>

    <!-- –§—É—Ç–µ—Ä -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>–û –º–∞–≥–∞–∑–∏–Ω–µ</h3>
                    <p style="color: #bdc3c7; line-height: 1.6;">
                        D13 - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –ø–æ —Ä–µ–º–æ–Ω—Ç—É —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞. 
                        –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ —Ä—ã–Ω–∫–µ –±–æ–ª–µ–µ 5 –ª–µ—Ç –∏ –∑–∞—Å–ª—É–∂–∏–ª–∏ –¥–æ–≤–µ—Ä–∏–µ —Ç—ã—Å—è—á –∫–ª–∏–µ–Ω—Ç–æ–≤.
                    </p>
                </div>
                <div class="footer-column">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +7 (923) 753-36-06</li>
                        <li><i class="fas fa-envelope"></i> prodtorg.barnaul@gmail.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> –≥. –ë–∞—Ä–Ω–∞—É–ª, —É–ª. –û—Å—Ç—Ä–æ–≤—Å–∫–æ–≥–æ, 10</li>
                        <li><i class="fas fa-clock"></i> –ü–Ω-–í—Å: 9:00-21:00</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 D13 - –ú–∞–≥–∞–∑–∏–Ω "–î–ª—è —Å–≤–æ–∏—Ö". –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let products = JSON.parse(localStorage.getItem('products')) || [];
        let categories = JSON.parse(localStorage.getItem('categories')) || [
            { id: 1, name: '–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è', icon: 'üß¥', description: '–ú–æ—é—â–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞, —Å—Ç–∏—Ä–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ—à–∫–∏, –≥–µ–ª–∏ –¥–ª—è –¥—É—à–∞' },
            { id: 2, name: '–≠–ª–µ–∫—Ç—Ä–æ–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç', icon: 'üîß', description: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞' },
            { id: 3, name: '–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã', icon: 'üîã', description: '–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤' },
            { id: 4, name: '–•–æ–∑—Ç–æ–≤–∞—Ä—ã', icon: 'üè†', description: '–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞ –∏ –±—ã—Ç–∞' }
        ];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        let filteredProducts = [...products];
        let currentUser = { name: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', role: 'admin', email: 'admin@myshop.ru' };
        let siteSettings = JSON.parse(localStorage.getItem('siteSettings')) || {
            heroTitle: 'D13 - –í—Å—ë –¥–ª—è –¥–æ–º–∞ –∏ —Ä–µ–º–æ–Ω—Ç–∞',
            heroText: '–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞, —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∏',
            background: 'gradient',
            primaryColor: '#2c5aa0',
            secondaryColor: '#1a3a6b'
        };

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        document.addEventListener('DOMContentLoaded', function() {
            initSite();
            loadCategories();
            loadProducts();
            updateCartCount();
            updateCategoryFilter();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (products.length === 0) {
                addSampleProducts();
            }
        });

        function initSite() {
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            applySiteSettings();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') searchProducts();
            });
        }

        function applySiteSettings() {
            if (siteSettings.background === 'gradient') {
                document.querySelector('.hero').style.background = 
                    `linear-gradient(135deg, ${siteSettings.primaryColor}, ${siteSettings.secondaryColor})`;
            }
            
            if (siteSettings.heroTitle) {
                document.getElementById('heroTitle').textContent = siteSettings.heroTitle;
            }
            
            if (siteSettings.heroText) {
                document.getElementById('heroText').textContent = siteSettings.heroText;
            }
        }

        function addSampleProducts() {
            const sampleProducts = [
                {
                    id: 1001,
                    name: 'FAIRY banane - 5 –ª–∏—Ç—Ä–æ–≤',
                    category: '–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è',
                    price: 800,
                    oldPrice: 950,
                    quantity: 15,
                    status: 'in_stock',
                    description: '–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è –º—ã—Ç—å—è –ø–æ—Å—É–¥—ã. –û–±—ä–µ–º: 5 –ª–∏—Ç—Ä–æ–≤. –ê—Ä–æ–º–∞—Ç: –ë–∞–Ω–∞–Ω.',
                    image: 'https://i.postimg.cc/0ypWMS33/FAIRY-BANANE-5-litrov.jpg',
                    brand: 'FAIRY'
                },
                {
                    id: 1002,
                    name: 'ASH20 - —á–∏—Å—Ç—è—â–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ - 5 –ª–∏—Ç—Ä–æ–≤',
                    category: '–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è',
                    price: 800,
                    oldPrice: null,
                    quantity: 8,
                    status: 'in_stock',
                    description: '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —á–∏—Å—Ç—è—â–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π.',
                    image: 'https://i.postimg.cc/VkjGrtT3/ASH20-cistasee-sredstvo-5-litrov.jpg',
                    brand: 'ASH20'
                }
            ];
            
            products.push(...sampleProducts);
            filteredProducts = [...products];
            saveData('products', products);
            loadProducts();
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –¢–û–í–ê–†–û–í ====================
        function loadProducts() {
            const productsGrid = document.getElementById('productsGrid');
            
            if (filteredProducts.length === 0) {
                productsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px;">
                        <i class="fas fa-box-open" style="font-size: 4rem; color: var(--gray-light); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--gray); margin-bottom: 15px;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                        <p style="color: var(--gray);">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
                    </div>
                `;
                return;
            }

            productsGrid.innerHTML = filteredProducts.map(product => {
                const discount = product.oldPrice ? 
                    Math.round((1 - product.price / product.oldPrice) * 100) : 0;
                const statusClass = `status-${product.status.replace('_', '-')}`;
                const statusText = getStatusText(product.status);
                
                return `
                    <div class="product-card">
                        ${discount > 0 ? `<div class="product-badge">-${discount}%</div>` : ''}
                        <div class="product-image-container">
                            <img src="${product.image}" alt="${product.name}" class="product-image"
                                 onerror="this.onerror=null; this.src='https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+—Ñ–æ—Ç–æ'">
                        </div>
                        <div class="product-info">
                            <div class="product-category">${product.category}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <div class="product-description-short">${product.description.substring(0, 100)}...</div>
                            
                            <div class="product-price">
                                <span class="current-price">${product.price.toLocaleString()} ‚ÇΩ</span>
                                ${product.oldPrice ? `<span class="old-price">${product.oldPrice.toLocaleString()} ‚ÇΩ</span>` : ''}
                                ${discount > 0 ? `<span class="discount">-${discount}%</span>` : ''}
                            </div>
                            
                            <div class="product-status ${statusClass}">
                                ${statusText} ${product.quantity > 0 ? `(${product.quantity} —à—Ç.)` : ''}
                            </div>
                            
                            <div class="product-actions">
                                <button class="btn btn-primary add-to-cart" onclick="addToCart(${product.id})" 
                                        ${product.status !== 'in_stock' || product.quantity <= 0 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i>
                                    ${product.status === 'in_stock' && product.quantity > 0 ? '–í –∫–æ—Ä–∑–∏–Ω—É' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                                </button>
                                <button class="btn btn-outline" onclick="showProductDetails(${product.id})">
                                    <i class="fas fa-info"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getStatusText(status) {
            const statuses = {
                'in_stock': '–í –Ω–∞–ª–∏—á–∏–∏',
                'out_of_stock': '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏',
                'pre_order': '–ü–æ–¥ –∑–∞–∫–∞–∑'
            };
            return statuses[status] || status;
        }

        function filterProducts() {
            const category = document.getElementById('categoryFilter').value;
            const priceRange = document.getElementById('priceFilter').value;
            
            filteredProducts = products.filter(product => {
                if (category && product.category !== category) return false;
                if (priceRange) {
                    const [min, max] = priceRange.split('-').map(Number);
                    if (product.price < min || product.price > max) return false;
                }
                return true;
            });
            
            loadProducts();
        }

        function sortProducts() {
            const sortBy = document.getElementById('sortBy').value;
            
            switch(sortBy) {
                case 'price_asc':
                    filteredProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price_desc':
                    filteredProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
            }
            
            loadProducts();
        }

        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                filteredProducts = [...products];
            } else {
                filteredProducts = products.filter(product =>
                    product.name.toLowerCase().includes(searchTerm) ||
                    product.description.toLowerCase().includes(searchTerm) ||
                    product.category.toLowerCase().includes(searchTerm) ||
                    (product.brand && product.brand.toLowerCase().includes(searchTerm))
                );
            }
            
            loadProducts();
        }

        function scrollToProducts() {
            document.getElementById('productsSection').scrollIntoView({ behavior: 'smooth' });
        }

        // ==================== –ö–ê–¢–ï–ì–û–†–ò–ò ====================
        function loadCategories() {
            const categoriesGrid = document.getElementById('categoriesGrid');
            categoriesGrid.innerHTML = categories.map(category => `
                <div class="category-card" onclick="filterByCategory('${category.name}')">
                    <span class="category-icon">${category.icon}</span>
                    <h3>${category.name}</h3>
                    <p class="category-description">${category.description}</p>
                </div>
            `).join('');
        }

        function filterByCategory(categoryName) {
            document.getElementById('categoryFilter').value = categoryName;
            filterProducts();
            scrollToProducts();
        }

        function updateCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');
            const uniqueCategories = [...new Set(products.map(p => p.category).concat(categories.map(c => c.name)))];
            
            categoryFilter.innerHTML = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>' +
                uniqueCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
        }

        // ==================== –ö–û–†–ó–ò–ù–ê ====================
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            if (product.status !== 'in_stock' || product.quantity <= 0) {
                showNotification('–¢–æ–≤–∞—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'error');
                return;
            }

            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                if (existingItem.quantity >= product.quantity) {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ', 'error');
                    return;
                }
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1,
                    maxQuantity: product.quantity
                });
            }
            
            saveData('cart', cart);
            updateCartCount();
            showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!', 'success');
        }

        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
        }

        function openCart() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            const cartEmpty = document.getElementById('cartEmpty');
            const cartTotal = document.getElementById('cartTotal');
            const totalAmount = document.getElementById('totalAmount');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '';
                cartEmpty.style.display = 'block';
                cartTotal.style.display = 'none';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div style="display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid var(--border);">
                        <img src="${item.image}" alt="${item.name}" 
                             style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;"
                             onerror="this.src='https://via.placeholder.com/60x60/ecf0f1/7f8c8d?text=–ù–µ—Ç'">
                        <div style="flex: 1;">
                            <div style="font-weight: bold; margin-bottom: 5px;">${item.name}</div>
                            <div style="color: var(--primary); font-weight: bold;">${item.price} ‚ÇΩ √ó ${item.quantity}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <button onclick="updateCartQuantity(${item.id}, -1)" 
                                    style="width: 30px; height: 30px; border: 1px solid var(--border); border-radius: 50%; background: white; cursor: pointer;">
                                -
                            </button>
                            <span>${item.quantity}</span>
                            <button onclick="updateCartQuantity(${item.id}, 1)"
                                    ${item.quantity >= item.maxQuantity ? 'disabled' : ''}
                                    style="width: 30px; height: 30px; border: 1px solid var(--border); border-radius: 50%; background: white; cursor: pointer; ${item.quantity >= item.maxQuantity ? 'opacity: 0.5; cursor: not-allowed;' : ''}">
                                +
                            </button>
                            <button onclick="removeFromCart(${item.id})" 
                                    style="background: var(--danger); color: white; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; margin-left: 10px;">
                                <i class="fas fa-trash" style="font-size: 12px;"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
                
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                totalAmount.textContent = total.toLocaleString();
                cartEmpty.style.display = 'none';
                cartTotal.style.display = 'block';
            }
            
            modal.style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function updateCartQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (!item) return;
            
            const newQuantity = item.quantity + change;
            
            if (newQuantity < 1) {
                removeFromCart(productId);
                return;
            }
            
            if (newQuantity > item.maxQuantity) {
                showNotification(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${item.maxQuantity}`, 'error');
                return;
            }
            
            item.quantity = newQuantity;
            saveData('cart', cart);
            updateCartCount();
            openCart();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveData('cart', cart);
            updateCartCount();
            openCart();
            showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã', 'info');
        }

        function checkout() {
            if (cart.length === 0) {
                showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–≤–∞—Ä–æ–≤
            for (const item of cart) {
                const product = products.find(p => p.id === item.id);
                if (!product || product.quantity < item.quantity) {
                    showNotification(`–¢–æ–≤–∞—Ä "${item.name}" –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ –Ω—É–∂–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ`, 'error');
                    return;
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product) {
                    product.quantity -= item.quantity;
                    if (product.quantity <= 0) {
                        product.status = 'out_of_stock';
                    }
                }
            });
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const newOrder = {
                id: orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1,
                date: new Date().toISOString(),
                items: [...cart],
                total: total,
                status: 'pending',
                customer: currentUser.name
            };
            
            orders.push(newOrder);
            saveData('orders', orders);
            saveData('products', products);
            
            // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
            cart = [];
            saveData('cart', cart);
            updateCartCount();
            closeModal('cartModal');
            
            showNotification(`–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –°—É–º–º–∞: ${total.toLocaleString()} ‚ÇΩ`, 'success');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
            filteredProducts = [...products];
            loadProducts();
        }

        // ==================== –ò–ú–ü–û–†–¢ –¢–û–í–ê–†–û–í ====================
        function showImportPanel() {
            document.getElementById('editOverlay').style.display = 'block';
            document.getElementById('editPanel').style.display = 'block';
            
            document.getElementById('editPanelContent').innerHTML = `
                <h3 style="margin-bottom: 20px;"><i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤</h3>
                
                <div style="margin-bottom: 25px;">
                    <h4 style="margin-bottom: 15px; color: var(--dark);">üì• –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞</h4>
                    <div style="border: 2px dashed var(--border); border-radius: var(--radius); padding: 30px; text-align: center; cursor: pointer;"
                         onclick="document.getElementById('fileInput').click()"
                         ondrop="handleDrop(event)"
                         ondragover="handleDragOver(event)"
                         id="dropZone">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--gray-light); margin-bottom: 15px;"></i>
                        <p style="margin-bottom: 10px; font-weight: bold;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                        <p style="color: var(--gray); font-size: 0.9rem;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: CSV, XLSX, XLS</p>
                        <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileSelect(this.files[0])">
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <h4 style="margin-bottom: 15px; color: var(--dark);">üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞</h4>
                    <div style="background: var(--light); padding: 15px; border-radius: var(--radius); font-size: 0.9rem;">
                        <p><strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:</strong> ID —Ç–æ–≤–∞—Ä–∞, –ö–∞—Ç–µ–≥–æ—Ä–∏—è, –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</p>
                        <p><strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ–ª—è:</strong> –û–ø–∏—Å–∞–Ω–∏–µ, –í –Ω–∞–ª–∏—á–∏–∏, –§–æ—Ç–æ (URL —Å—Å—ã–ª–∫–∞), –ë—Ä–µ–Ω–¥</p>
                        <p><strong>–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã CSV:</strong></p>
                        <pre style="background: white; padding: 10px; border-radius: 5px; overflow-x: auto;">
ID —Ç–æ–≤–∞—Ä–∞,–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞,–ë—Ä–µ–Ω–¥,–û–ø–∏—Å–∞–Ω–∏–µ,–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏,–í –Ω–∞–ª–∏—á–∏–∏,–§–æ—Ç–æ (URL —Å—Å—ã–ª–∫–∞)
BH-001,–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è,FAIRY banane - 5 –ª–∏—Ç—Ä–æ–≤,FAIRY,"–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞",800,–¥–∞,https://example.com/photo.jpg</pre>
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <h4 style="margin-bottom: 15px; color: var(--dark);">‚ö° –ë—ã—Å—Ç—Ä—ã–π –∏–º–ø–æ—Ä—Ç –∏–∑ —Ç–µ–∫—Å—Ç–∞</h4>
                    <textarea id="quickImport" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV –∑–¥–µ—Å—å..." 
                              style="width: 100%; padding: 15px; border: 1px solid var(--border); border-radius: var(--radius); font-family: monospace; min-height: 150px;"></textarea>
                    <button onclick="importFromText()" class="btn btn-primary" style="margin-top: 10px;">
                        <i class="fas fa-bolt"></i> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞
                    </button>
                </div>
                
                <div id="importResults" style="display: none;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            `;
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
            event.dataTransfer.dropEffect = 'copy';
            document.getElementById('dropZone').style.borderColor = 'var(--primary)';
            document.getElementById('dropZone').style.background = 'rgba(44, 90, 160, 0.05)';
        }

        function handleDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('dropZone').style.borderColor = 'var(--border)';
            document.getElementById('dropZone').style.background = '';
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelect(files[0]);
            }
        }

        function handleFileSelect(file) {
            if (!file) return;
            
            const fileExtension = file.name.split('.').pop().toLowerCase();
            
            if (fileExtension === 'csv') {
                importCSV(file);
            } else if (fileExtension === 'xlsx' || fileExtension === 'xls') {
                importExcel(file);
            } else {
                showNotification('‚ùå –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ CSV –∏ Excel —Ñ–∞–π–ª—ã', 'error');
            }
        }

        function importExcel(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    processImportData(jsonData, 'Excel');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ Excel:', error);
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ Excel —Ñ–∞–π–ª–∞', 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function importCSV(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const csvData = e.target.result;
                    const lines = csvData.split('\n');
                    const headers = lines[0].split(',').map(h => h.trim());
                    
                    const jsonData = [];
                    for (let i = 1; i < lines.length; i++) {
                        if (lines[i].trim() === '') continue;
                        
                        const values = lines[i].split(',').map(v => v.trim());
                        if (values.length !== headers.length) continue;
                        
                        const row = {};
                        headers.forEach((header, index) => {
                            row[header] = values[index];
                        });
                        jsonData.push(row);
                    }
                    
                    processImportData(jsonData, 'CSV');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ CSV:', error);
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ CSV —Ñ–∞–π–ª–∞', 'error');
                }
            };
            
            reader.readAsText(file, 'UTF-8');
        }

        function importFromText() {
            const text = document.getElementById('quickImport').value.trim();
            if (!text) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞', 'error');
                return;
            }
            
            try {
                const lines = text.split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                
                const jsonData = [];
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim() === '') continue;
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å —É—á–µ—Ç–æ–º –∑–∞–ø—è—Ç—ã—Ö –≤–Ω—É—Ç—Ä–∏ –∫–∞–≤—ã—á–µ–∫
                    const values = parseCSVLine(lines[i]);
                    if (values.length !== headers.length) continue;
                    
                    const row = {};
                    headers.forEach((header, index) => {
                        row[header] = values[index].trim();
                    });
                    jsonData.push(row);
                }
                
                processImportData(jsonData, '—Ç–µ–∫—Å—Ç–∞');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞', 'error');
            }
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        function processImportData(jsonData, sourceType) {
            if (jsonData.length === 0) {
                showNotification('–§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö', 'error');
                return;
            }
            
            let importedCount = 0;
            let updatedCount = 0;
            let errorCount = 0;
            let newCategories = new Set();
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
            const headerMapping = {
                'id —Ç–æ–≤–∞—Ä–∞': 'id',
                '–∫–æ–¥_—Ç–æ–≤–∞—Ä–∞': 'id',
                '–∫–∞—Ç–µ–≥–æ—Ä–∏—è': 'category',
                '–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞': 'name',
                '–Ω–∞–∑–≤–∞–Ω–∏–µ': 'name',
                '–±—Ä–µ–Ω–¥': 'brand',
                '–æ–ø–∏—Å–∞–Ω–∏–µ': 'description',
                '—Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏': 'price',
                '—Ü–µ–Ω–∞_–ø—Ä–æ–¥–∞–∂–∏': 'price',
                '—Ü–µ–Ω–∞': 'price',
                '–≤ –Ω–∞–ª–∏—á–∏–∏': 'quantity',
                '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ': 'quantity',
                '—Ñ–æ—Ç–æ (url —Å—Å—ã–ª–∫–∞)': 'image',
                '—Ñ–æ—Ç–æ': 'image',
                '–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ': 'image',
                '—Å—Ç–∞—Ç—É—Å': 'status'
            };
            
            jsonData.forEach((row, index) => {
                try {
                    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
                    const normalizedRow = {};
                    Object.keys(row).forEach(key => {
                        const cleanKey = key.toLowerCase().trim();
                        const mappedKey = headerMapping[cleanKey] || cleanKey;
                        normalizedRow[mappedKey] = row[key];
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
                    if (!normalizedRow.name || !normalizedRow.category) {
                        errorCount++;
                        return;
                    }
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º ID
                    let productId;
                    if (normalizedRow.id) {
                        // –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å —á–∏—Å–ª–æ–≤–æ–π ID
                        const idStr = normalizedRow.id.toString();
                        const match = idStr.match(/\d+/);
                        productId = match ? parseInt(match[0]) * 1000 + index : Date.now() + index;
                    } else {
                        productId = Date.now() + index;
                    }
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ü–µ–Ω—É
                    let price = 0;
                    if (normalizedRow.price) {
                        price = parseInt(normalizedRow.price.toString().replace(/[^\d]/g, '')) || 0;
                    }
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
                    let quantity = 0;
                    let status = 'out_of_stock';
                    
                    if (normalizedRow.quantity) {
                        const qtyStr = normalizedRow.quantity.toString().toLowerCase();
                        if (qtyStr === '–¥–∞' || qtyStr === 'yes' || qtyStr === 'true') {
                            quantity = 10; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            status = 'in_stock';
                        } else if (!isNaN(parseInt(qtyStr))) {
                            quantity = parseInt(qtyStr);
                            status = quantity > 0 ? 'in_stock' : 'out_of_stock';
                        }
                    }
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    let image = normalizedRow.image || '';
                    if (!image || image.trim() === '') {
                        image = 'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+—Ñ–æ—Ç–æ';
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ —Å–ø–∏—Å–æ–∫
                    newCategories.add(normalizedRow.category);
                    
                    // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Ç–æ–≤–∞—Ä–∞
                    const newProduct = {
                        id: productId,
                        name: normalizedRow.name.toString().trim(),
                        category: normalizedRow.category.toString().trim(),
                        price: price,
                        oldPrice: null,
                        quantity: quantity,
                        status: status,
                        description: (normalizedRow.description || '–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞').toString().trim(),
                        image: image.toString().trim(),
                        brand: normalizedRow.brand || ''
                    };
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π —Ç–æ–≤–∞—Ä (–ø–æ –∏–º–µ–Ω–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
                    const existingIndex = products.findIndex(p => 
                        p.name.toLowerCase() === newProduct.name.toLowerCase() && 
                        p.category.toLowerCase() === newProduct.category.toLowerCase()
                    );
                    
                    if (existingIndex !== -1) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–æ–≤–∞—Ä
                        products[existingIndex] = {
                            ...products[existingIndex],
                            ...newProduct,
                            id: products[existingIndex].id // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π ID
                        };
                        updatedCount++;
                    } else {
                        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
                        products.push(newProduct);
                        importedCount++;
                    }
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫–∏:', error);
                    errorCount++;
                }
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            newCategories.forEach(categoryName => {
                if (!categories.some(c => c.name === categoryName)) {
                    categories.push({
                        id: categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1,
                        name: categoryName,
                        icon: 'üì¶',
                        description: `–¢–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${categoryName}`
                    });
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            saveData('products', products);
            saveData('categories', categories);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            filteredProducts = [...products];
            loadProducts();
            loadCategories();
            updateCategoryFilter();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            showImportResults(importedCount, updatedCount, errorCount, newCategories.size);
            
            showNotification(`‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –î–æ–±–∞–≤–ª–µ–Ω–æ: ${importedCount}, –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${updatedCount}`, 'success');
        }

        function showImportResults(imported, updated, errors, newCategories) {
            const resultsDiv = document.getElementById('importResults');
            resultsDiv.style.display = 'block';
            
            resultsDiv.innerHTML = `
                <div style="background: var(--light); border-radius: var(--radius); padding: 20px; margin-top: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--dark);">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–ø–æ—Ä—Ç–∞</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="text-align: center; padding: 15px; background: white; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--success);">${imported}</div>
                            <div>–ù–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--primary);">${updated}</div>
                            <div>–û–±–Ω–æ–≤–ª–µ–Ω–æ</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent);">${newCategories}</div>
                            <div>–ù–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--danger);">${errors}</div>
                            <div>–û—à–∏–±–æ–∫</div>
                        </div>
                    </div>
                    
                    <div style="background: white; border-radius: var(--radius); padding: 15px;">
                        <p><strong>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –±–∞–∑–µ:</strong> ${products.length}</p>
                        <p><strong>–í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:</strong> ${categories.length}</p>
                        <p style="margin-top: 10px; color: var(--gray); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> –¢–æ–≤–∞—Ä—ã —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å–∞–π—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏.
                        </p>
                    </div>
                </div>
            `;
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // ==================== –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–ò–í–ù–´–ô –ö–û–ù–°–¢–†–£–ö–¢–û–† ====================
        function toggleConstructor() {
            const toolbar = document.getElementById('constructorToolbar');
            const editButtons = document.getElementById('editButtons');
            
            if (toolbar.classList.contains('expanded')) {
                toolbar.classList.remove('expanded');
                editButtons.style.display = 'none';
            } else {
                toolbar.classList.add('expanded');
                editButtons.style.display = 'flex';
            }
        }

        function editBackground() {
            openEditPanel('background', 'üé® –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ–Ω–∞', `
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–¢–∏–ø —Ñ–æ–Ω–∞:</label>
                    <select id="bgType" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                        <option value="gradient" ${siteSettings.background === 'gradient' ? 'selected' : ''}>–ì—Ä–∞–¥–∏–µ–Ω—Ç</option>
                        <option value="solid" ${siteSettings.background === 'solid' ? 'selected' : ''}>–°–ø–ª–æ—à–Ω–æ–π —Ü–≤–µ—Ç</option>
                    </select>
                </div>
                
                <div id="gradientSettings" style="${siteSettings.background !== 'gradient' ? 'display: none;' : ''}">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px;">–¶–≤–µ—Ç 1:</label>
                            <input type="color" id="color1" value="${siteSettings.primaryColor || '#2c5aa0'}" style="width: 100%; height: 40px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px;">–¶–≤–µ—Ç 2:</label>
                            <input type="color" id="color2" value="${siteSettings.secondaryColor || '#1a3a6b'}" style="width: 100%; height: 40px;">
                        </div>
                    </div>
                </div>
                
                <div id="solidSettings" style="${siteSettings.background !== 'solid' ? 'display: none;' : ''}">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 8px;">–¶–≤–µ—Ç —Ñ–æ–Ω–∞:</label>
                        <input type="color" id="solidColor" value="${siteSettings.solidColor || '#2c5aa0'}" style="width: 100%; height: 40px;">
                    </div>
                </div>
                
                <script>
                    document.getElementById('bgType').addEventListener('change', function() {
                        document.getElementById('gradientSettings').style.display = this.value === 'gradient' ? 'block' : 'none';
                        document.getElementById('solidSettings').style.display = this.value === 'solid' ? 'block' : 'none';
                    });
                </script>
            `);
        }

        function editHeader() {
            openEditPanel('header', 'üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–ø–∫–∏', `
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞:</label>
                    <input type="text" id="siteTitle" value="${siteSettings.heroTitle || 'D13 - –í—Å—ë –¥–ª—è –¥–æ–º–∞ –∏ —Ä–µ–º–æ–Ω—Ç–∞'}" 
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–û–ø–∏—Å–∞–Ω–∏–µ —Å–∞–π—Ç–∞:</label>
                    <textarea id="siteDescription" rows="3" 
                              style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">${siteSettings.heroText || '–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞, —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∏'}</textarea>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                    <input type="text" id="sitePhone" value="+7 (923) 753-36-06" 
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">Email:</label>
                    <input type="email" id="siteEmail" value="prodtorg.barnaul@gmail.com" 
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
            `);
        }

        function editCategories() {
            openEditPanel('categories', 'üìÇ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏', `
                <div style="margin-bottom: 20px;">
                    <button onclick="showAddCategoryForm()" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                    </button>
                </div>
                
                <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                    ${categories.map((category, index) => `
                        <div style="background: var(--light); border-radius: var(--radius); padding: 15px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.5rem;">${category.icon}</span>
                                    <div>
                                        <div style="font-weight: bold;">${category.name}</div>
                                        <div style="font-size: 0.9rem; color: var(--gray);">${category.description}</div>
                                    </div>
                                </div>
                                <div>
                                    <button onclick="editCategory(${index})" class="btn btn-sm btn-outline" style="margin-right: 5px;">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteCategory(${index})" class="btn btn-sm btn-danger">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `);
        }

        function manageProducts() {
            openEditPanel('products', 'üõçÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏', `
                <div style="margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="productSearch" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." 
                               style="padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);"
                               onkeyup="searchProductsInEditor()">
                        <button onclick="showAddProductForm()" class="btn btn-primary">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                
                <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;" id="productsList">
                    <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <script>
                    loadProductsForEditor();
                </script>
            `);
        }

        function manageOrders() {
            openEditPanel('orders', 'üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏', `
                <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                    ${orders.length === 0 ? `
                        <div style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>–ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç</p>
                        </div>
                    ` : orders.map(order => `
                        <div style="background: var(--light); border-radius: var(--radius); padding: 15px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                <div>
                                    <div style="font-weight: bold;">–ó–∞–∫–∞–∑ #${order.id}</div>
                                    <div style="font-size: 0.9rem; color: var(--gray);">
                                        ${new Date(order.date).toLocaleDateString('ru-RU')} ‚Ä¢ ${order.customer}
                                    </div>
                                </div>
                                <span style="background: ${order.status === 'completed' ? 'var(--accent)' : order.status === 'pending' ? 'var(--warning)' : 'var(--gray)'}; 
                                      color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;">
                                    ${order.status === 'completed' ? '–í—ã–ø–æ–ª–Ω–µ–Ω' : order.status === 'pending' ? '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' : '–û—Ç–º–µ–Ω–µ–Ω'}
                                </span>
                            </div>
                            <div style="font-size: 0.9rem;">
                                <div><strong>–¢–æ–≤–∞—Ä—ã:</strong> ${order.items.length} —à—Ç.</div>
                                <div><strong>–°—É–º–º–∞:</strong> ${order.total.toLocaleString()} ‚ÇΩ</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `);
        }

        function openEditPanel(type, title, content) {
            document.getElementById('editOverlay').style.display = 'block';
            document.getElementById('editPanel').style.display = 'block';
            
            document.getElementById('editPanelContent').innerHTML = `
                <h3 style="margin-bottom: 20px;">${title}</h3>
                <div id="editContent">
                    ${content}
                </div>
            `;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∏–ø —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('editPanel').dataset.editType = type;
        }

        function applyChanges() {
            const type = document.getElementById('editPanel').dataset.editType;
            
            switch(type) {
                case 'background':
                    applyBackgroundChanges();
                    break;
                case 'header':
                    applyHeaderChanges();
                    break;
                case 'categories':
                    // –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ
                    break;
                case 'products':
                    // –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ
                    break;
            }
            
            closePanel();
        }

        function applyBackgroundChanges() {
            const bgType = document.querySelector('#bgType')?.value || 'gradient';
            
            if (bgType === 'gradient') {
                const color1 = document.querySelector('#color1')?.value || '#2c5aa0';
                const color2 = document.querySelector('#color2')?.value || '#1a3a6b';
                
                siteSettings.background = 'gradient';
                siteSettings.primaryColor = color1;
                siteSettings.secondaryColor = color2;
                
                document.querySelector('.hero').style.background = 
                    `linear-gradient(135deg, ${color1}, ${color2})`;
            } else {
                const solidColor = document.querySelector('#solidColor')?.value || '#2c5aa0';
                
                siteSettings.background = 'solid';
                siteSettings.solidColor = solidColor;
                
                document.querySelector('.hero').style.background = solidColor;
            }
            
            saveData('siteSettings', siteSettings);
            showNotification('–§–æ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
        }

        function applyHeaderChanges() {
            const title = document.querySelector('#siteTitle')?.value;
            const description = document.querySelector('#siteDescription')?.value;
            const phone = document.querySelector('#sitePhone')?.value;
            const email = document.querySelector('#siteEmail')?.value;
            
            if (title) {
                siteSettings.heroTitle = title;
                document.getElementById('heroTitle').textContent = title;
            }
            
            if (description) {
                siteSettings.heroText = description;
                document.getElementById('heroText').textContent = description;
            }
            
            if (phone || email) {
                const contacts = document.querySelector('.header-contacts');
                if (contacts) {
                    contacts.innerHTML = `
                        <i class="fas fa-phone"></i> ${phone || '+7 (923) 753-36-06'}
                        <span style="margin: 0 15px">|</span>
                        <i class="fas fa-envelope"></i> ${email || 'prodtorg.barnaul@gmail.com'}
                    `;
                }
            }
            
            saveData('siteSettings', siteSettings);
            showNotification('–®–∞–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
        }

        function showAddCategoryForm() {
            document.getElementById('editContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="newCatName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏):</label>
                    <input type="text" id="newCatIcon" placeholder="üì¶"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);" value="üì¶">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="newCatDesc" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
                              style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="saveNewCategory()" class="btn btn-success" style="flex: 1;">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button onclick="editCategories()" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                </div>
            `;
        }

        function saveNewCategory() {
            const name = document.querySelector('#newCatName')?.value;
            const icon = document.querySelector('#newCatIcon')?.value;
            const description = document.querySelector('#newCatDesc')?.value;
            
            if (!name || !icon) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            const newCategory = {
                id: categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1,
                name: name,
                icon: icon,
                description: description || `–¢–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${name}`
            };
            
            categories.push(newCategory);
            saveData('categories', categories);
            loadCategories();
            updateCategoryFilter();
            editCategories();
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
        }

        function editCategory(index) {
            const category = categories[index];
            
            document.getElementById('editContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="editCatName" value="${category.name}"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏):</label>
                    <input type="text" id="editCatIcon" value="${category.icon}"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="editCatDesc" rows="3"
                              style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">${category.description}</textarea>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="saveCategoryChanges(${index})" class="btn btn-success" style="flex: 1;">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button onclick="editCategories()" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                </div>
            `;
        }

        function saveCategoryChanges(index) {
            const name = document.querySelector('#editCatName')?.value;
            const icon = document.querySelector('#editCatIcon')?.value;
            const description = document.querySelector('#editCatDesc')?.value;
            
            if (!name || !icon) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            categories[index] = {
                ...categories[index],
                name: name,
                icon: icon,
                description: description
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            products.forEach(product => {
                if (product.category === categories[index].name) {
                    product.category = name;
                }
            });
            
            saveData('categories', categories);
            saveData('products', products);
            loadCategories();
            loadProducts();
            updateCategoryFilter();
            editCategories();
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
        }

        function deleteCategory(index) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é? –¢–æ–≤–∞—Ä—ã –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.')) {
                return;
            }
            
            const categoryName = categories[index].name;
            
            // –£–¥–∞–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            categories.splice(index, 1);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã
            products.forEach(product => {
                if (product.category === categoryName) {
                    product.category = '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';
                }
            });
            
            saveData('categories', categories);
            saveData('products', products);
            loadCategories();
            loadProducts();
            updateCategoryFilter();
            editCategories();
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞', 'info');
        }

        function loadProductsForEditor() {
            const productsList = document.getElementById('productsList');
            
            if (products.length === 0) {
                productsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--gray);">
                        <i class="fas fa-box-open" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–¢–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç</p>
                    </div>
                `;
                return;
            }
            
            productsList.innerHTML = products.map((product, index) => `
                <div class="product-editor-item" style="background: var(--light); border-radius: var(--radius); padding: 15px; margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                        <div style="display: flex; align-items: start; gap: 15px; flex: 1;">
                            <img src="${product.image}" alt="${product.name}" 
                                 style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;"
                                 onerror="this.src='https://via.placeholder.com/60x60/ecf0f1/7f8c8d?text=–ù–µ—Ç'">
                            <div style="flex: 1;">
                                <div style="font-weight: bold; margin-bottom: 5px;">${product.name}</div>
                                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">${product.category}</div>
                                <div style="font-size: 0.9rem;"><strong>–¶–µ–Ω–∞:</strong> ${product.price} ‚ÇΩ ‚Ä¢ <strong>–ù–∞–ª–∏—á–∏–µ:</strong> ${product.quantity} —à—Ç.</div>
                            </div>
                        </div>
                        <div>
                            <button onclick="editProductInEditor(${index})" class="btn btn-sm btn-outline" style="margin-right: 5px;">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteProductFromEditor(${index})" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function searchProductsInEditor() {
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            const items = document.querySelectorAll('.product-editor-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }

        function showAddProductForm() {
            document.getElementById('editContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="newProdName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                    <select id="newProdCategory" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        ${categories.map(cat => `<option value="${cat.name}">${cat.name}</option>`).join('')}
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">–¶–µ–Ω–∞:</label>
                        <input type="number" id="newProdPrice" placeholder="–¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö"
                               style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                        <input type="number" id="newProdQuantity" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ" value="10"
                               style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                    </div>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (URL):</label>
                    <input type="text" id="newProdImage" placeholder="https://example.com/photo.jpg"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="newProdDesc" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
                              style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="saveNewProductInEditor()" class="btn btn-success" style="flex: 1;">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button onclick="manageProducts()" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                </div>
            `;
        }

        function saveNewProductInEditor() {
            const name = document.querySelector('#newProdName')?.value;
            const category = document.querySelector('#newProdCategory')?.value;
            const price = parseInt(document.querySelector('#newProdPrice')?.value) || 0;
            const quantity = parseInt(document.querySelector('#newProdQuantity')?.value) || 0;
            const image = document.querySelector('#newProdImage')?.value;
            const description = document.querySelector('#newProdDesc')?.value;
            
            if (!name || !category || price <= 0) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ü–µ–Ω–∞)', 'error');
                return;
            }
            
            const newProduct = {
                id: Date.now(),
                name: name,
                category: category,
                price: price,
                oldPrice: null,
                quantity: quantity,
                status: quantity > 0 ? 'in_stock' : 'out_of_stock',
                description: description || '–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞',
                image: image || 'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+—Ñ–æ—Ç–æ',
                brand: ''
            };
            
            products.push(newProduct);
            saveData('products', products);
            filteredProducts = [...products];
            loadProducts();
            updateCategoryFilter();
            manageProducts();
            showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω', 'success');
        }

        function editProductInEditor(index) {
            const product = products[index];
            
            document.getElementById('editContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="editProdName" value="${product.name}"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                    <select id="editProdCategory" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        ${categories.map(cat => `<option value="${cat.name}" ${cat.name === product.category ? 'selected' : ''}>${cat.name}</option>`).join('')}
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">–¶–µ–Ω–∞:</label>
                        <input type="number" id="editProdPrice" value="${product.price}"
                               style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                        <input type="number" id="editProdQuantity" value="${product.quantity}"
                               style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                    </div>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (URL):</label>
                    <input type="text" id="editProdImage" value="${product.image}"
                           style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="editProdDesc" rows="3"
                              style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: var(--radius);">${product.description}</textarea>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="saveProductChanges(${index})" class="btn btn-success" style="flex: 1;">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button onclick="manageProducts()" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                </div>
            `;
        }

        function saveProductChanges(index) {
            const name = document.querySelector('#editProdName')?.value;
            const category = document.querySelector('#editProdCategory')?.value;
            const price = parseInt(document.querySelector('#editProdPrice')?.value) || 0;
            const quantity = parseInt(document.querySelector('#editProdQuantity')?.value) || 0;
            const image = document.querySelector('#editProdImage')?.value;
            const description = document.querySelector('#editProdDesc')?.value;
            
            if (!name || !category || price <= 0) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ü–µ–Ω–∞)', 'error');
                return;
            }
            
            products[index] = {
                ...products[index],
                name: name,
                category: category,
                price: price,
                quantity: quantity,
                status: quantity > 0 ? 'in_stock' : 'out_of_stock',
                description: description,
                image: image
            };
            
            saveData('products', products);
            filteredProducts = [...products];
            loadProducts();
            updateCategoryFilter();
            manageProducts();
            showNotification('–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
        }

        function deleteProductFromEditor(index) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')) return;
            
            products.splice(index, 1);
            saveData('products', products);
            filteredProducts = [...products];
            loadProducts();
            updateCategoryFilter();
            manageProducts();
            showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω', 'info');
        }

        function closePanel() {
            document.getElementById('editOverlay').style.display = 'none';
            document.getElementById('editPanel').style.display = 'none';
        }

        function saveDesign() {
            showNotification('üíæ –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        // ==================== –£–¢–ò–õ–ò–¢–´ ====================
        function saveData(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        function showNotification(message, type = 'success') {
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : 'var(--primary)'};
                color: white;
                padding: 15px 25px;
                border-radius: var(--radius);
                box-shadow: var(--shadow);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 400px;
            `;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
            
            // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏–∏
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        function openProfile() {
            showNotification('üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'info');
        }

        function logout() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?')) {
                showNotification('üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!', 'info');
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –æ—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–∏
            }
        }

        function showProductDetails(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const discount = product.oldPrice ? 
                Math.round((1 - product.price / product.oldPrice) * 100) : 0;
            
            const detailsHTML = `
                <div style="max-width: 600px; margin: 0 auto;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="${product.image}" alt="${product.name}" 
                             style="max-width: 100%; max-height: 300px; border-radius: var(--radius);"
                             onerror="this.src='https://via.placeholder.com/400x300/ecf0f1/7f8c8d?text=–ù–µ—Ç+—Ñ–æ—Ç–æ'">
                    </div>
                    
                    <h2 style="margin-bottom: 15px;">${product.name}</h2>
                    
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <span style="font-size: 1.8rem; font-weight: bold; color: var(--primary);">
                            ${product.price.toLocaleString()} ‚ÇΩ
                        </span>
                        ${product.oldPrice ? `
                            <span style="font-size: 1.2rem; color: var(--gray); text-decoration: line-through;">
                                ${product.oldPrice.toLocaleString()} ‚ÇΩ
                            </span>
                            <span style="background: var(--accent); color: white; padding: 5px 10px; border-radius: 15px; font-weight: bold;">
                                -${discount}%
                            </span>
                        ` : ''}
                    </div>
                    
                    <div style="background: var(--light); border-radius: var(--radius); padding: 15px; margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                            <div>
                                <div style="font-size: 0.9rem; color: var(--gray);">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</div>
                                <div style="font-weight: bold;">${product.category}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9rem; color: var(--gray);">–ù–∞–ª–∏—á–∏–µ</div>
                                <div style="font-weight: bold; color: ${product.status === 'in_stock' && product.quantity > 0 ? 'var(--success)' : 'var(--danger)'}">
                                    ${product.status === 'in_stock' && product.quantity > 0 ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                                    ${product.quantity > 0 ? ` (${product.quantity} —à—Ç.)` : ''}
                                </div>
                            </div>
                            ${product.brand ? `
                                <div>
                                    <div style="font-size: 0.9rem; color: var(--gray);">–ë—Ä–µ–Ω–¥</div>
                                    <div style="font-weight: bold;">${product.brand}</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 10px;">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                        <p style="line-height: 1.6;">${product.description}</p>
                    </div>
                    
                    <button onclick="addToCart(${product.id}); closeModal('productDetailsModal');" 
                            class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 1.1rem;"
                            ${product.status !== 'in_stock' || product.quantity <= 0 ? 'disabled' : ''}>
                        <i class="fas fa-shopping-cart"></i>
                        ${product.status === 'in_stock' && product.quantity > 0 ? '–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É' : '–¢–æ–≤–∞—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}
                    </button>
                </div>
            `;
            
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞
            const modal = document.createElement('div');
            modal.id = 'productDetailsModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: var(--radius); padding: 30px; max-width: 800px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative;">
                    <button onclick="closeModal('productDetailsModal')" 
                            style="position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray);">
                        &times;
                    </button>
                    ${detailsHTML}
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    if (modal.parentNode) {
                        modal.parentNode.removeChild(modal);
                    }
                }, 300);
            }
        };

        // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        if (!document.querySelector('#modal-styles')) {
            const style = document.createElement('style');
            style.id = 'modal-styles';
            style.textContent = `
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }

        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏
        window.toggleConstructor = toggleConstructor;
        window.editBackground = editBackground;
        window.editHeader = editHeader;
        window.editCategories = editCategories;
        window.manageProducts = manageProducts;
        window.manageOrders = manageOrders;
        window.showImportPanel = showImportPanel;
        window.closePanel = closePanel;
        window.applyChanges = applyChanges;
        window.saveDesign = saveDesign;
        window.logout = logout;
        window.openCart = openCart;
        window.closeModal = closeModal;
        window.addToCart = addToCart;
        window.updateCartQuantity = updateCartQuantity;
        window.removeFromCart = removeFromCart;
        window.checkout = checkout;
        window.openProfile = openProfile;
        window.filterByCategory = filterByCategory;
        window.filterProducts = filterProducts;
        window.searchProducts = searchProducts;
        window.sortProducts = sortProducts;
        window.scrollToProducts = scrollToProducts;
        window.showProductDetails = showProductDetails;
        window.handleFileSelect = handleFileSelect;
        window.handleDragOver = handleDragOver;
        window.handleDrop = handleDrop;
        window.importFromText = importFromText;
    </script>
</body>
</html>
