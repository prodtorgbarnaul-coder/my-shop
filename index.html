<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥–∞–∑–∏–Ω "–î–ª—è —Å–≤–æ–∏—Ö" - –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c5aa0;
            --secondary: #e74c3c;
            --accent: #27ae60;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --gray: #6c757d;
            --border: #e9ecef;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* –ö–û–ù–¢–ï–ô–ù–ï–†–´ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* –®–ê–ü–ö–ê */
        header {
            background: white;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-top {
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            color: white;
            padding: 8px 0;
            font-size: 14px;
        }

        .header-main {
            padding: 15px 0;
        }

        .header-main .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .search-bar {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid var(--border);
            border-radius: 30px;
            font-size: 14px;
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-action {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--dark);
            font-size: 12px;
        }

        .header-action i {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .cart-count {
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -5px;
            right: -5px;
        }

        /* HERO SECTION */
        .hero {
            color: white;
            padding: 100px 0 60px;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* –ö–ê–¢–ï–ì–û–†–ò–ò */
        .categories-section {
            padding: 60px 0;
            background: white;
            border-radius: 20px;
            margin: 0 15px 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .section-title {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 40px;
            color: var(--dark);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .category-card {
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            border-radius: 15px;
            padding: 30px 20px;
            text-align: center;
            color: white;
            text-decoration: none;
            transition: transform 0.3s ease;
        }

        .category-card:hover {
            transform: translateY(-5px);
        }

        .category-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        /* –¢–û–í–ê–†–´ */
        .products-section {
            padding: 60px 0;
            background: white;
            border-radius: 20px;
            margin: 0 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .product-info {
            padding: 20px;
        }

        .product-name {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .product-price {
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .add-to-cart {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        /* –ö–û–ù–°–¢–†–£–ö–¢–û–† */
        .constructor-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), #1a3a6b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .constructor-menu {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .constructor-menu.show {
            display: block;
        }

        .constructor-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            border-radius: 8px;
        }

        .constructor-btn:hover {
            background: var(--light);
        }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            font-size: 24px;
            cursor: pointer;
        }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .search-bar {
                min-width: 100%;
                order: 3;
                margin-top: 15px;
            }
            
            .header-main .container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- –®–ê–ü–ö–ê -->
    <header>
        <div class="header-top">
            <div class="container">
                <div class="header-contacts">
                    <i class="fas fa-phone"></i> +7 (923) 753-36-06
                    <span style="margin: 0 15px">|</span>
                    <i class="fas fa-envelope"></i> prodtorg.barnaul@gmail.com
                </div>
            </div>
        </div>
        <div class="header-main">
            <div class="container">
                <a href="#" class="logo">–î–õ–Ø –°–í–û–ò–•<span>.</span></a>
                
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
                    <button onclick="searchProducts()"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="header-actions">
                    <a href="#" class="header-action" onclick="openModal('profileModal')">
                        <i class="far fa-user"></i>
                        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                    </a>
                    <a href="#" class="header-action" onclick="openModal('cartModal')" style="position: relative;">
                        <i class="fas fa-shopping-cart"></i>
                        <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
                        <div class="cart-count" id="cartCount">0</div>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù -->
    <section class="hero">
        <div class="container">
            <h1>–ú–∞–≥–∞–∑–∏–Ω –¥–ª—è —Å–≤–æ–∏—Ö</h1>
            <p>–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –Ω–∞—à–µ–≥–æ –∫—Ä—É–≥–∞</p>
        </div>
    </section>

    <!-- –ö–ê–¢–ï–ì–û–†–ò–ò -->
    <section class="categories-section">
        <div class="container">
            <h2 class="section-title">–ö–ê–¢–ï–ì–û–†–ò–ò –¢–û–í–ê–†–û–í</h2>
            <div class="categories-grid" id="categoriesGrid">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </section>

    <!-- –¢–û–í–ê–†–´ -->
    <section class="products-section">
        <div class="container">
            <h2 class="section-title">–ü–û–ü–£–õ–Ø–†–ù–´–ï –¢–û–í–ê–†–´</h2>
            <div class="products-grid" id="productsGrid">
                <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </section>

    <!-- –ö–û–ù–°–¢–†–£–ö–¢–û–† -->
    <div class="constructor-toggle" onclick="toggleConstructor()">
        <i class="fas fa-cog"></i>
    </div>
    
    <div class="constructor-menu" id="constructorMenu">
        <button class="constructor-btn" onclick="editProducts()">
            <i class="fas fa-box"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
        </button>
        <button class="constructor-btn" onclick="editCategories()">
            <i class="fas fa-folder"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        </button>
        <button class="constructor-btn" onclick="importProducts()">
            <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤
        </button>
        <button class="constructor-btn" onclick="exportData()">
            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        </button>
        <button class="constructor-btn" onclick="openAdminMode()">
            <i class="fas fa-user-shield"></i> –†–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        </button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–û–†–ó–ò–ù–´ -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üõí –ö–æ—Ä–∑–∏–Ω–∞</h3>
                <span class="close-modal" onclick="closeModal('cartModal')">&times;</span>
            </div>
            <div id="cartItems">
                <p style="text-align: center; color: var(--gray); padding: 40px 0;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
            </div>
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid var(--border);">
                <div style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: bold;">
                    <span>–ò—Ç–æ–≥–æ:</span>
                    <span id="cartTotal">0 ‚ÇΩ</span>
                </div>
                <button class="add-to-cart" style="margin-top: 20px;" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–§–ò–õ–Ø -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
                <span class="close-modal" onclick="closeModal('profileModal')">&times;</span>
            </div>
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="width: 80px; height: 80px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; margin: 0 auto 15px;">–ê</div>
                <h3>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h3>
                <p style="color: var(--gray);">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞</p>
            </div>
            <div style="margin-top: 20px;">
                <p><strong>Email:</strong> admin@myshop.ru</p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (923) 753-36-06</p>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –£–ü–†–ê–í–õ–ï–ù–ò–Ø –¢–û–í–ê–†–ê–ú–ò -->
    <div class="modal" id="productsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üõçÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
                <span class="close-modal" onclick="closeModal('productsModal')">&times;</span>
            </div>
            <div id="productsModalContent">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <script>
        // ==================== –î–ê–ù–ù–´–ï ====================
        let products = JSON.parse(localStorage.getItem('products')) || [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let categories = JSON.parse(localStorage.getItem('categories')) || [
            { name: '–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è', icon: 'üß¥', color: '#667eea' },
            { name: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', icon: 'üì±', color: '#f093fb' },
            { name: '–û–¥–µ–∂–¥–∞', icon: 'üëï', color: '#4facfe' },
            { name: '–ü—Ä–æ–¥—É–∫—Ç—ã', icon: 'üçé', color: '#43e97b' },
            { name: '–ö–æ—Å–º–µ—Ç–∏–∫–∞', icon: 'üíÑ', color: '#fa709a' }
        ];

        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function initApp() {
            loadCategories();
            loadProducts();
            updateCartCount();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (products.length === 0) {
                addTestProducts();
            }
        }

        function loadCategories() {
            const grid = document.getElementById('categoriesGrid');
            grid.innerHTML = categories.map(category => `
                <div class="category-card" onclick="filterByCategory('${category.name}')" 
                     style="background: linear-gradient(135deg, ${category.color}, ${adjustColor(category.color, -20)})">
                    <div class="category-icon">${category.icon}</div>
                    <h3>${category.name}</h3>
                </div>
            `).join('');
        }

        function loadProducts() {
            const grid = document.getElementById('productsGrid');
            
            if (products.length === 0) {
                grid.innerHTML = '<p style="text-align: center; grid-column: 1/-1; color: var(--gray); padding: 40px;">–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }
            
            grid.innerHTML = products.map(product => `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}" class="product-image" 
                         onerror="this.src='https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'">
                    <div class="product-info">
                        <div style="color: var(--gray); font-size: 0.9rem; margin-bottom: 5px;">${product.category}</div>
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">${product.price} ‚ÇΩ</div>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            `).join('');
        }

        function addTestProducts() {
            const testProducts = [
                {
                    id: 1,
                    name: 'FAIRY banane - 5 –ª–∏—Ç—Ä–æ–≤',
                    category: '–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è',
                    price: 800,
                    image: 'https://via.placeholder.com/300x200/667eea/ffffff?text=FAIRY'
                },
                {
                    id: 2,
                    name: '–°–º–∞—Ä—Ç—Ñ–æ–Ω Xiaomi',
                    category: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
                    price: 15000,
                    image: 'https://via.placeholder.com/300x200/f093fb/ffffff?text=Xiaomi'
                },
                {
                    id: 3,
                    name: '–§—É—Ç–±–æ–ª–∫–∞ —Ö–ª–æ–ø–∫–æ–≤–∞—è',
                    category: '–û–¥–µ–∂–¥–∞',
                    price: 1200,
                    image: 'https://via.placeholder.com/300x200/4facfe/ffffff?text=–§—É—Ç–±–æ–ª–∫–∞'
                },
                {
                    id: 4,
                    name: '–ú–æ–ª–æ–∫–æ 3.2%',
                    category: '–ü—Ä–æ–¥—É–∫—Ç—ã',
                    price: 85,
                    image: 'https://via.placeholder.com/300x200/43e97b/ffffff?text=–ú–æ–ª–æ–∫–æ'
                }
            ];
            
            products = testProducts;
            localStorage.setItem('products', JSON.stringify(products));
            loadProducts();
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    ...product,
                    quantity: 1
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!');
        }

        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
        }

        function openModal(modalId) {
            if (modalId === 'cartModal') {
                updateCartModal();
            }
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function updateCartModal() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 40px 0;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
                cartTotal.textContent = '0 ‚ÇΩ';
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div style="display: flex; align-items: center; gap: 15px; padding: 15px 0; border-bottom: 1px solid var(--border);">
                    <img src="${item.image}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">
                    <div style="flex: 1;">
                        <div style="font-weight: bold;">${item.name}</div>
                        <div>${item.price} ‚ÇΩ √ó ${item.quantity}</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button onclick="changeQuantity(${item.id}, -1)" style="width: 30px; height: 30px; border: 1px solid var(--border); border-radius: 50%; background: white;">-</button>
                        <span>${item.quantity}</span>
                        <button onclick="changeQuantity(${item.id}, 1)" style="width: 30px; height: 30px; border: 1px solid var(--border); border-radius: 50%; background: white;">+</button>
                        <button onclick="removeFromCart(${item.id})" style="color: var(--secondary); border: none; background: none; cursor: pointer;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = total + ' ‚ÇΩ';
        }

        function changeQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (!item) return;
            
            item.quantity += change;
            if (item.quantity <= 0) {
                removeFromCart(productId);
            } else {
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                updateCartModal();
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            updateCartModal();
            showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
        }

        function checkout() {
            if (cart.length === 0) {
                showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            showNotification(`‚úÖ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –°—É–º–º–∞: ${total} ‚ÇΩ`);
            cart = [];
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            closeModal('cartModal');
        }

        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const grid = document.getElementById('productsGrid');
            
            if (!searchTerm.trim()) {
                loadProducts();
                return;
            }
            
            const filtered = products.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm)
            );
            
            if (filtered.length === 0) {
                grid.innerHTML = '<p style="text-align: center; grid-column: 1/-1; color: var(--gray); padding: 40px;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            grid.innerHTML = filtered.map(product => `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div style="color: var(--gray); font-size: 0.9rem; margin-bottom: 5px;">${product.category}</div>
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">${product.price} ‚ÇΩ</div>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            `).join('');
        }

        function filterByCategory(category) {
            const grid = document.getElementById('productsGrid');
            const filtered = products.filter(product => product.category === category);
            
            if (filtered.length === 0) {
                grid.innerHTML = '<p style="text-align: center; grid-column: 1/-1; color: var(--gray); padding: 40px;">–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }
            
            grid.innerHTML = filtered.map(product => `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div style="color: var(--gray); font-size: 0.9rem; margin-bottom: 5px;">${product.category}</div>
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">${product.price} ‚ÇΩ</div>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            `).join('');
        }

        // ==================== –ö–û–ù–°–¢–†–£–ö–¢–û–† ====================
        function toggleConstructor() {
            document.getElementById('constructorMenu').classList.toggle('show');
        }

        function editProducts() {
            closeModal('productsModal');
            setTimeout(() => {
                document.getElementById('productsModalContent').innerHTML = `
                    <h4 style="margin-bottom: 20px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ (${products.length})</h4>
                    
                    <button onclick="showAddProductForm()" 
                            style="width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; margin-bottom: 20px;">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                    </button>
                    
                    <button onclick="importFromFile()" 
                            style="width: 100%; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px; margin-bottom: 20px;">
                        <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç –∏–∑ —Ñ–∞–π–ª–∞
                    </button>
                    
                    <div style="max-height: 300px; overflow-y: auto; margin-top: 20px;">
                        ${products.map((product, index) => `
                            <div style="display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid var(--border);">
                                <img src="${product.image}" alt="${product.name}" 
                                     style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">
                                <div style="flex: 1;">
                                    <div style="font-weight: bold;">${product.name}</div>
                                    <div style="color: var(--gray); font-size: 0.9rem;">${product.category} ‚Ä¢ ${product.price} ‚ÇΩ</div>
                                </div>
                                <div>
                                    <button onclick="editProduct(${index})" style="background: none; border: none; color: var(--primary); cursor: pointer; margin-right: 10px;">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteProduct(${index})" style="background: none; border: none; color: var(--secondary); cursor: pointer;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                openModal('productsModal');
            }, 300);
        }

        function showAddProductForm() {
            document.getElementById('productsModalContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" id="newProductName" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="newProductCategory" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        ${categories.map(cat => `<option value="${cat.name}">${cat.name}</option>`).join('')}
                    </select>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–¶–µ–Ω–∞ (‚ÇΩ)</label>
                    <input type="number" id="newProductPrice" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="newProductImage" placeholder="https://example.com/image.jpg" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="editProducts()" style="flex: 1; padding: 12px; background: var(--gray); color: white; border: none; border-radius: 8px;">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button onclick="saveNewProduct()" style="flex: 1; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px;">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            `;
        }

        function saveNewProduct() {
            const name = document.getElementById('newProductName').value;
            const category = document.getElementById('newProductCategory').value;
            const price = parseInt(document.getElementById('newProductPrice').value);
            const image = document.getElementById('newProductImage').value;
            
            if (!name || !category || !price) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            const newProduct = {
                id: Date.now(),
                name: name,
                category: category,
                price: price,
                image: image || 'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'
            };
            
            products.push(newProduct);
            localStorage.setItem('products', JSON.stringify(products));
            
            showNotification('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!');
            editProducts();
            loadProducts();
        }

        function editProduct(index) {
            const product = products[index];
            
            document.getElementById('productsModalContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" id="editProductName" value="${product.name}" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="editProductCategory" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                        ${categories.map(cat => 
                            `<option value="${cat.name}" ${cat.name === product.category ? 'selected' : ''}>${cat.name}</option>`
                        ).join('')}
                    </select>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–¶–µ–Ω–∞ (‚ÇΩ)</label>
                    <input type="number" id="editProductPrice" value="${product.price}" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="editProductImage" value="${product.image}" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="editProducts()" style="flex: 1; padding: 12px; background: var(--gray); color: white; border: none; border-radius: 8px;">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button onclick="saveEditedProduct(${index})" style="flex: 1; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px;">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            `;
        }

        function saveEditedProduct(index) {
            const name = document.getElementById('editProductName').value;
            const category = document.getElementById('editProductCategory').value;
            const price = parseInt(document.getElementById('editProductPrice').value);
            const image = document.getElementById('editProductImage').value;
            
            if (!name || !category || !price) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            products[index] = {
                ...products[index],
                name: name,
                category: category,
                price: price,
                image: image || 'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'
            };
            
            localStorage.setItem('products', JSON.stringify(products));
            
            showNotification('‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω!');
            editProducts();
            loadProducts();
        }

        function deleteProduct(index) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')) {
                products.splice(index, 1);
                localStorage.setItem('products', JSON.stringify(products));
                showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω');
                editProducts();
                loadProducts();
            }
        }

        function importFromFile() {
            document.getElementById('productsModalContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤</h4>
                
                <div style="text-align: center; padding: 40px 20px; border: 3px dashed var(--border); border-radius: 15px; margin-bottom: 20px; cursor: pointer;" 
                     onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                    <h4>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞</h4>
                    <p style="color: var(--gray);">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è CSV –∏ Excel —Ñ–∞–π–ª—ã</p>
                    <input type="file" id="fileInput" accept=".csv,.xlsx" style="display: none;" onchange="handleFileImport(this.files[0])">
                </div>
                
                <div style="background: var(--light); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <h5 style="margin-bottom: 10px;">üìã –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞:</h5>
                    <p style="font-size: 0.9rem; color: var(--gray);">
                        –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞;–ö–∞—Ç–µ–≥–æ—Ä–∏—è;–¶–µ–Ω–∞;URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è<br>
                        –ü—Ä–∏–º–µ—Ä: FAIRY banane;–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è;800;https://example.com/image.jpg
                    </p>
                </div>
                
                <button onclick="editProducts()" 
                        style="width: 100%; padding: 12px; background: var(--gray); color: white; border: none; border-radius: 8px;">
                    –ù–∞–∑–∞–¥
                </button>
            `;
        }

        function handleFileImport(file) {
            if (!file) return;
            
            const reader = new FileReader();
            const fileExtension = file.name.split('.').pop().toLowerCase();
            
            if (fileExtension === 'csv') {
                reader.onload = function(e) {
                    try {
                        const csvData = e.target.result;
                        const lines = csvData.split('\n').filter(line => line.trim() !== '');
                        
                        let imported = 0;
                        let errors = 0;
                        
                        for (let i = 0; i < lines.length; i++) {
                            const values = lines[i].split(';').map(v => v.trim());
                            if (values.length >= 3) {
                                const [name, category, price, image] = values;
                                
                                const newProduct = {
                                    id: Date.now() + i,
                                    name: name,
                                    category: category,
                                    price: parseInt(price) || 0,
                                    image: image || 'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'
                                };
                                
                                products.push(newProduct);
                                imported++;
                            } else {
                                errors++;
                            }
                        }
                        
                        localStorage.setItem('products', JSON.stringify(products));
                        showNotification(`‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –î–æ–±–∞–≤–ª–µ–Ω–æ: ${imported}, –û—à–∏–±–æ–∫: ${errors}`);
                        editProducts();
                        loadProducts();
                        
                    } catch (error) {
                        showNotification('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV —Ñ–∞–π–ª–∞', 'error');
                    }
                };
                reader.readAsText(file, 'UTF-8');
            } else if (fileExtension === 'xlsx') {
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                        
                        jsonData.forEach((row, index) => {
                            const newProduct = {
                                id: Date.now() + index,
                                name: row['–ù–∞–∑–≤–∞–Ω–∏–µ'] || row['–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞'] || `–¢–æ–≤–∞—Ä ${index + 1}`,
                                category: row['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'] || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏',
                                price: parseInt(row['–¶–µ–Ω–∞'] || row['–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏'] || 0),
                                image: row['–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'] || row['URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'] || 
                                      'https://via.placeholder.com/300x200/ecf0f1/7f8c8d?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'
                            };
                            
                            products.push(newProduct);
                        });
                        
                        localStorage.setItem('products', JSON.stringify(products));
                        showNotification(`‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –î–æ–±–∞–≤–ª–µ–Ω–æ ${jsonData.length} —Ç–æ–≤–∞—Ä–æ–≤`);
                        editProducts();
                        loadProducts();
                        
                    } catch (error) {
                        showNotification('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ Excel —Ñ–∞–π–ª–∞', 'error');
                    }
                };
                reader.readAsArrayBuffer(file);
            } else {
                showNotification('‚ùå –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ CSV –∏ Excel —Ñ–∞–π–ª—ã', 'error');
            }
        }

        function editCategories() {
            closeModal('productsModal');
            setTimeout(() => {
                document.getElementById('productsModalContent').innerHTML = `
                    <h4 style="margin-bottom: 20px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h4>
                    
                    <button onclick="showAddCategoryForm()" 
                            style="width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; margin-bottom: 20px;">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                    </button>
                    
                    <div style="max-height: 300px; overflow-y: auto; margin-top: 20px;">
                        ${categories.map((category, index) => `
                            <div style="display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid var(--border);">
                                <div style="font-size: 2rem;">${category.icon}</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: bold;">${category.name}</div>
                                    <div style="color: var(--gray); font-size: 0.9rem;">
                                        –¢–æ–≤–∞—Ä–æ–≤: ${products.filter(p => p.category === category.name).length}
                                    </div>
                                </div>
                                <div>
                                    <button onclick="editCategory(${index})" style="background: none; border: none; color: var(--primary); cursor: pointer; margin-right: 10px;">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteCategory(${index})" style="background: none; border: none; color: var(--secondary); cursor: pointer;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                openModal('productsModal');
            }, 300);
        }

        function showAddCategoryForm() {
            document.getElementById('productsModalContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                    <input type="text" id="newCategoryName" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏)</label>
                    <input type="text" id="newCategoryIcon" value="üì¶" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–¶–≤–µ—Ç</label>
                    <input type="color" id="newCategoryColor" value="#667eea" style="width: 100%; height: 50px;">
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="editCategories()" style="flex: 1; padding: 12px; background: var(--gray); color: white; border: none; border-radius: 8px;">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button onclick="saveNewCategory()" style="flex: 1; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px;">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            `;
        }

        function saveNewCategory() {
            const name = document.getElementById('newCategoryName').value;
            const icon = document.getElementById('newCategoryIcon').value;
            const color = document.getElementById('newCategoryColor').value;
            
            if (!name || !icon) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            categories.push({
                name: name,
                icon: icon,
                color: color
            });
            
            localStorage.setItem('categories', JSON.stringify(categories));
            showNotification('‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
            editCategories();
            loadCategories();
        }

        function editCategory(index) {
            const category = categories[index];
            
            document.getElementById('productsModalContent').innerHTML = `
                <h4 style="margin-bottom: 20px;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                    <input type="text" id="editCategoryName" value="${category.name}" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏)</label>
                    <input type="text" id="editCategoryIcon" value="${category.icon}" 
                           style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">–¶–≤–µ—Ç</label>
                    <input type="color" id="editCategoryColor" value="${category.color}" style="width: 100%; height: 50px;">
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="editCategories()" style="flex: 1; padding: 12px; background: var(--gray); color: white; border: none; border-radius: 8px;">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button onclick="saveEditedCategory(${index})" style="flex: 1; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px;">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            `;
        }

        function saveEditedCategory(index) {
            const name = document.getElementById('editCategoryName').value;
            const icon = document.getElementById('editCategoryIcon').value;
            const color = document.getElementById('editCategoryColor').value;
            
            if (!name || !icon) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            categories[index] = {
                name: name,
                icon: icon,
                color: color
            };
            
            localStorage.setItem('categories', JSON.stringify(categories));
            showNotification('‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
            editCategories();
            loadCategories();
        }

        function deleteCategory(index) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?')) {
                categories.splice(index, 1);
                localStorage.setItem('categories', JSON.stringify(categories));
                showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞');
                editCategories();
                loadCategories();
            }
        }

        function importProducts() {
            importFromFile();
            openModal('productsModal');
        }

        function exportData() {
            const data = {
                products: products,
                categories: categories,
                cart: cart,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup_${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('üìÅ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
        }

        function openAdminMode() {
            showNotification('üîß –†–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function adjustColor(color, amount) {
            let usePound = false;
            if (color[0] === "#") {
                color = color.slice(1);
                usePound = true;
            }
            const num = parseInt(color, 16);
            let r = (num >> 16) + amount;
            if (r > 255) r = 255;
            else if (r < 0) r = 0;
            let b = ((num >> 8) & 0x00FF) + amount;
            if (b > 255) b = 255;
            else if (b < 0) b = 0;
            let g = (num & 0x0000FF) + amount;
            if (g > 255) g = 255;
            else if (g < 0) g = 0;
            return (usePound ? "#" : "") + (g | (b << 8) | (r << 16)).toString(16).padStart(6, '0');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? 'var(--secondary)' : 'var(--accent)'};
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ==================== –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ====================
        document.addEventListener('DOMContentLoaded', initApp);
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        };
    </script>
</body>
</html>
